%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{XNS}
\date{Oct 28, 2021}
\release{1.0.0}
\author{Jacopo Soldateschi}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\sphinxAtStartPar
The XNS code solves for axisymmetric equilibria of polytropic magnetized and/or rotating neutron stars (NSs) using the extended conformally flat condition (XCFC) for the metric, in spherical coordinates. This is based on the metric module and the routines developed for the X\sphinxhyphen{}ECHO code for GRMHD in dynamical spacetimes (Bucciantini \& Del Zanna 2011), which in turn is an upgrade of the Eulerian conservative high\sphinxhyphen{}order code (ECHO Del Zanna et al. 2007) for GRMHD in a static background metric (the so\sphinxhyphen{}called Cowling approximation). Like ECHO and X\sphinxhyphen{}ECHO, also XNS is written in the Fortran90 programming language. The reader is referred to the above cited paper for full derivation of the GRMHD equations, and for the full description of the XCFC solvers.

\sphinxAtStartPar
The 4.0 version of XNS adds the possibility of solving for the structure of a magnetised, rotating NS in a class of theories of gravity alternative to general relativity (GR), that is massless scalar tensor theories (STTs). Moreover, support for the use of realistic, tabulated equations of state (EoS) has been added.

\sphinxAtStartPar
This guide is based on the following papers, where the equations describing the approach for magnetized models are fully presented:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Bucciantini N., \& Del Zanna L., 2011, A\&A, 528, A101 (link).

\item {} 
\sphinxAtStartPar
Pili A.G., Bucciantini N., \& Del Zanna L., 2014, MNRAS, 439, 3541 (link).

\item {} 
\sphinxAtStartPar
Pili A.G., Bucciantini N., \& Del Zanna L., 2015, MNRAS, 447, 2821 (link).

\item {} 
\sphinxAtStartPar
Pili A.G., Bucciantini N., \& Del Zanna L., 2017, MNRAS, 470, 2469 (link).

\item {} 
\sphinxAtStartPar
Soldateschi, J., Bucciantini, N., \& Del Zanna, L. 2020, A\&A, 640, A44 (hereafter SBD20) (link).

\item {} 
\sphinxAtStartPar
Soldateschi, J., Bucciantini, N., \& Del Zanna, L. 2021, A\&A, 645, A39 (link).

\item {} 
\sphinxAtStartPar
Soldateschi, J., Bucciantini, N., \& Del Zanna, L. 2021, A\&A, arXiv:2106.00603v3 {[}astro\sphinxhyphen{}ph.HE{]} (link).

\end{itemize}

\sphinxAtStartPar
If you use this software please reference at least one of the previous papers.


\chapter{Compiling XNS}
\label{\detokenize{makefile:compiling-xns}}\label{\detokenize{makefile::doc}}
\sphinxAtStartPar
XNS can be compiled using gfortran in several ways, as written in the file \sphinxstyleemphasis{makefile}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
make serial \sphinxhyphen{} the standard way to compile XNS. In this case a single solution is found with a central density specified by the parameter RHOINI. The generated executable is named \sphinxstyleemphasis{XNS\sphinxhyphen{}s}. To compile the code this way type:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
    make clean\PYG{p}{;} make serial\PYG{p}{;} ./XNS\PYGZhy{}s
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
make nwtrps \sphinxhyphen{} compiles XNS using the Newton\sphinxhyphen{}Raphson method to converge on the quantity specified by the parameters QUOC and QUCONV. The generated executable is named \sphinxstyleemphasis{XNS\sphinxhyphen{}nr}. To compile the code this way type:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
    make clean\PYG{p}{;} make nwtrps\PYG{p}{;} ./XNS\PYGZhy{}nr
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
make parspace \sphinxhyphen{} compiles XNS various times with different initial conditions, in order to sample the parameter space spanned by the magnetic, rotation and density parameters, set in \sphinxstyleemphasis{XNS.f90}. In particular, solutions are computed with: NKB different magnetic coefficients spanning from KBMIN to KBMAX; NRHO1 different central densities spanning from RHOMIN to RHOMAX; NOMG different central angular velocities spanning from OMGMIN to OMGMAX. The generated executable is named \sphinxstyleemphasis{XNS\sphinxhyphen{}mpi}. The computation of the various models is made in parallel (only on CPUs, no GPU support) using the MPI framework, and mpif90 needs to be installed. To compile the code this way using NUMBER\_OF\_PROCESSES processes, type:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
    make clean\PYG{p}{;} make parspace\PYG{p}{;} mpirun \PYGZhy{}n NUMBER\PYGZus{}OF\PYGZus{}PROCESSES ./XNS\PYGZhy{}mpi
\end{sphinxVerbatim}

\sphinxAtStartPar
Note that it must be NUMBER\_OF\_PROCESSES\(\geq\)2, because one process is always only passing initial conditions to the other processes, and NUMBER\_OF\_PROCESSES\sphinxhyphen{}1\(\leq\)(NOMG+1)\(\times\)(NRHO1+1)\(\times\)(NKB+1), that is the number of computing processes must not be larger than the number of models to be computed.


\item {} 
\sphinxAtStartPar
make clean \sphinxhyphen{} removes all \sphinxstyleemphasis{.o} and \sphinxstyleemphasis{.mod} files and all executables.


\item {} 
\sphinxAtStartPar
make cleanall \sphinxhyphen{} removes all \sphinxstyleemphasis{.o} and \sphinxstyleemphasis{.mod} files, all executables as well as all \sphinxstyleemphasis{.dat} files.

\end{itemize}


\chapter{User parameters}
\label{\detokenize{user_params:user-parameters}}\label{\detokenize{user_params::doc}}
\sphinxAtStartPar
The input parameters that the user might want to change are all set in the module system inside the file \sphinxstyleemphasis{SYSTEM.f90}. There are other parameters in other parts of the code that deal with specific routines (root finding, convergence etc …), but those should not need to be changed. Here is a list of the parameters of the model as they appear in the module system:


\section{Convergence}
\label{\detokenize{user_params:convergence}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{NVALUE} \sphinxhyphen{} the maximum number of loops employable by the Newton\sphinxhyphen{}Raphson scheme in the search
for a equilibrium solution, having a target value for a desired quantity (central density, total mass,
etc..) by the program XNS. Usually convergence is reached within about 10 steps, unless the NS is
strongly distorted (fast rotation, and/or strong magnetic field). The default value is set to 100.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{MAXLOOP} \sphinxhyphen{} the maximum number of loops employable in the search for a converged equilibrium
solution by the subroutine XNSMAIN. Usually convergence is reached within the first 100 steps,
unless the NS is strongly distorted (fast rotation, and/or strong magnetic field). The default value is
set to 1000.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{MAXSTEP} \sphinxhyphen{} the maximum number of loops in TOVINIMOD for the convergence of the TOV system to a solution with a fixed scalar field. Note that the full TOV solution is obtained when also the scalar field has reached convergence together with the rest of the quantities.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{RELIT} \sphinxhyphen{} the maximum number of loops in TOVINIMOD for the convergence of the scalar field in the TOV system and for the convergence of the full TOV solution.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{CONV} \sphinxhyphen{} a convergence parameter for the Newton\sphinxhyphen{}Raphson scheme in XNS. It is given in relative terms
(beware that the code accuracy is \(\sim 10^{-3}\)).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{EPS} \sphinxhyphen{} a tolerance value. It is used in several subroutines and must be a small value. This should not
need to be changed.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{TOLCONV} \sphinxhyphen{} the convergence tolerance for the iterative solution of the PDEs for the conformal factor \(\psi\)
and the lapse \(\alpha\) in XNSMAIN and for the 4\sphinxhyphen{}potential in HYDROEQ.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{OSCCONV} \sphinxhyphen{} desired precision in case the solution is reached with oscillatory convergence in XNSMAIN. Currently it is not used.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{MONCONV} \sphinxhyphen{} desired precision in case the solution is reached with monotonous convergence in XNSMAIN.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{CONVF} \sphinxhyphen{} desired precision for the Newton\sphinxhyphen{}Raphson scheme in XNS.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{TOLCHI} \sphinxhyphen{} desired precision for the scalar field iterative solver in XNSMAIN.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{CONV2} \sphinxhyphen{} desired precision for the convergence of the scalar field in TOVINIMOD.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{QFACTOR} \sphinxhyphen{} a damping factor of the convergence loop both for solving the Bernoulli equation, used in HYDROEQ.
At the end of each sub\sphinxhyphen{}loop of the convergence scheme, a new set of equilibrium fluid variables is
computed. Setting QFACTOR=1 implies that these will be used, while setting QFACTOR=0 means that
the old variables \(V_\mathrm{old}\) will be used (the code will never converge in this case!). A value \(0 < Q_\mathrm{f} < 1\)
implies that at the beginning of each loop a combination of new and old variables will be used, in the
form \(V = Q_\mathrm{f}V_\mathrm{new} + (1 − Q_\mathrm{f})V_\mathrm{old}\).
Using a value less than 1 tends to give slower but more stable convergence. Values QFACTOR\( < 0.5\)
are to be used only for pathological cases where the convergence is very slow or when the code fails
to converge (i.e. rotating models on the unstable branch of NS mass\sphinxhyphen{}radius curve).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{QAPHI} \sphinxhyphen{} a damping factor of the convergence loop for solving the Grad\sphinxhyphen{}Shafranov or the Maxwell\sphinxhyphen{}Ampere equation. Analogous to QFACTOR but for the \(\phi\)\sphinxhyphen{}component of the 4\sphinxhyphen{}potential.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{QRELAX} \sphinxhyphen{} a damping factor for the convergence loop of the scalar field in TOVINIMOD.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{QFACTORMETRIC} \sphinxhyphen{} a damping factor for the internal convergence loop for solving the conformal factor equation in XNSMAIN.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{QFACTORCONF} \sphinxhyphen{} a damping factor for the conformal factor in the convergence loop of XNSMAIN.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{QFACTORCHI} \sphinxhyphen{} a damping factor for the internal convergence loop for solving the scalar field equation in XNSMAIN.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{CONVHELP} \sphinxhyphen{} a logical flag to activate an option in HYDROEQ to help achieve convergence. Warning: if set to .TRUE., the final central density will be slightly different from the chosen RHOINI.

\end{itemize}


\section{Grid}
\label{\detokenize{user_params:grid}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{NR} \sphinxhyphen{} the number of radial grid points. The radial grid is defined from \(r=\)RMIN and \(r=\)RMAX (\(r=\)RMAXSTR) is the grid is uniform (stretched).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{NTH} \sphinxhyphen{} the number of angular grid points. The angular grid is always defined between \(\theta = 0\) and \(\theta = \pi\).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{NRREG} \sphinxhyphen{} number of grid points for the regular grid if STRETCH=.TRUE..


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{RINI} \sphinxhyphen{} a very small radius used for the expansion of the TOV equations.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{RMIN} \sphinxhyphen{} the lower boundary in the radial direction. It must be always set to 0, since the metric solver
requires a compact domain and has been implemented with specific boundary conditions for RMIN = 0.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{RMAX} \sphinxhyphen{} the maximum radius of the computational domain if the grid is uniform. This can be arbitrarily chosen. However,
one needs to guarantee that the NS is properly resolved over a sufficient number of grid points (50\sphinxhyphen{}
100), so this parameter and NR should be chosen consistently. In particular, the condition RMAX\( >
2R_\mathrm{TOV}\) must hold, where \(R_\mathrm{TOV}\) is the NS radius of the initial TOV guess. This is because the TOV
solver is designed to converge when the ADM masses measured at RMAX and RMAX/2 (hence it must
be outside the NS) coincide within a given tolerance. If not the code will halt with a warning.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{RMAXSTR} \sphinxhyphen{} the maximum radius of the computational domain if the grid is stretched.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{MINRESREG} \sphinxhyphen{} desired minimum resolution of the grid, if uniform. In case the resolution is too rough, it allows to issue a warning.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{MINRESSTR} \sphinxhyphen{} desired minimum resolution of the regular part of the grid, if stretched. In case the resolution is too rough, it allows to issue a warning.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{RREG} \sphinxhyphen{} maximum radius of the regular grid.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{REQMAX} \sphinxhyphen{} the maximum radius beyond which any NS model will be artificially truncated. This must
be set \(\geq\) of the shedding mass limit. Sometimes, when working with configurations close to mass
shedding, during the convergence loop the code might get unbounded solutions or fail to converge. To
avoid this, setting a value for REQMAX will force the solution to be truncated.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{STRETCH} \sphinxhyphen{} a logical flag that control whether the grid is stretched or not. If .TRUE. the radial grid
is regular up to RREG with NRREG grid points and it is stretched from RREG to RMAXSTR with NR\sphinxhyphen{}NRREG
points. The stretching factor STRR is determined by the code determined by the code consistently with
the choices for NR, NRREG,RMAXSTR and RREG. See also Pili et al. (2015) for details.

\end{itemize}


\section{Printing outputs and files}
\label{\detokenize{user_params:printing-outputs-and-files}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{VERBOSE} \sphinxhyphen{} a logical flag. Setting VERBOSE=.TRUE. forces the code to output on screen all the INFOs
related to the various steps done by each subroutine (to be used only for debugging or checks). Otherwise setting VERBOSE=.FALSE. the output on screen will be produced only at the end. The latter is
the default option.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{DEBUG} \sphinxhyphen{} additional logical flag used to print more outputs. Used for debugging purposes.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{WRT} \sphinxhyphen{} a logical flag. Setting WRT=.TRUE. forces the code and each subroutine to write output files
at every step or substep, otherwise setting WRT=.FALSE. will prevent IO writing.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{WRTF} \sphinxhyphen{} a logical flag. Setting WRTF=.TRUE. override WRT for the final step, and allow to write all the
files related to the final configuration. Setting WRTF=.FALSE. will prevent IO writing.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{CHUP} \sphinxhyphen{} a logical flag. Setting CHUP=.TRUE. allows (subject to WRT, WRTF) to write the files containing the results of the metric solver and primitive solver XShiftphi.dat, Conformal.dat, Primitive.dat,
Primitive\_mag.dat, Shiftphi.dat, Lapse.dat, Source.dat, Rhovec.dat, Chi.dat. Setting CHUP=.FALSE. will prevent from writing these files. The latter is the default option, unless one wishes to perform a check of the metric or primitive solvers.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{WGRID} \sphinxhyphen{} a logical flag. Setting WGRID=.TRUE. writes the grid in a file named Grid.dat.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{WCONVA} \sphinxhyphen{} a logical flag. Setting WCONVA=.TRUE. writes two files named Apconv.dat and Atconv.dat used to check the convergence of the \(t\) and \(\phi\) components of the 4\sphinxhyphen{}potential.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{WCONVC} \sphinxhyphen{}  a logical flag. Setting WCONVC=.TRUE. writes a file named Chiconv.dat used to check the convergence of the scalar field.

\end{itemize}


\section{Rotation}
\label{\detokenize{user_params:rotation}}
\sphinxAtStartPar
\sphinxstylestrong{Warning: rotation in concurrency with the presence of a scalar field has not been tested!}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{OMG} \sphinxhyphen{} the value of the angular velocity at the center \(\Omega _\mathrm{c}\).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{A2VALUE} \sphinxhyphen{} the value of A2. This is needed only for differentially rotating models, otherwise it should
be set to 0.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{DIFFERENTIAL} \sphinxhyphen{} a logical flag that states whether the model is differentially rotating or not. Setting it
to .FALSE. implies uniform rotation, with \(\Omega = \)OMG. Setting it to .TRUE. implies differential rotation.
In this case, a value of A2VALUE must be specified.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{OMGSPACE} \sphinxhyphen{}


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{JCONSTLAW} \sphinxhyphen{}


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{JCMODLAW} \sphinxhyphen{}


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{URYULAW3} \sphinxhyphen{}


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{URYULAW4} \sphinxhyphen{}


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{PROTDIFF} \sphinxhyphen{}


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{OMGMAX} \sphinxhyphen{}


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{RMVALUE} \sphinxhyphen{}

\end{itemize}


\section{Magnetic field}
\label{\detokenize{user_params:magnetic-field}}
\sphinxAtStartPar
\sphinxstylestrong{Warning: a twisted torus configuration in concurrency with the presence of a scalar field has not been tested!}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{IMAG} \sphinxhyphen{} a logical flag that states whether the model is magnetized or not. Setting it to .FALSE. implies
the non magnetized case. Setting it to .TRUE. implies the presence of a magnetic field. In the latter
case, values of parameters for the magnetic model must be specified.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{ITOR} \sphinxhyphen{} a logical flag that must be set true only for purely toroidal configurations.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{IPOL} \sphinxhyphen{} a logical flag that must be set true only for purely poloidal configurations.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{ITWT} \sphinxhyphen{} a logical flag that must be set true only for mixed Twisted Torus configurations.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{BCOEF} \sphinxhyphen{} the value of Km in the magnetic polytropic law for the case of purely toroidal field. Never
used when IMAG=.FALSE. or ITOR=.FALSE., though it is better set to 0 in this case.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{MAGIND} \sphinxhyphen{} the value of m in the magnetic polytropic law for the case of purely toroidal field. It must be \(> 1\), otherwise the magnetic energy diverges on the polar axis. It is never used when IMAG=.FALSE.
or ITOR=.FALSE..


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{KBPOL} \sphinxhyphen{} the value of \(K_\mathrm{pol}\) in the magnetic law for the case of purely poloidal field. Never used when
IMAG=.FALSE. or IPOL=.FALSE., though it is better set to 0 in this case.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{CSI} \sphinxhyphen{} the value of the parameter \(\xi\) (non linear current term) in the magnetic polytropic law for the
case of purely poloidal field. It is never used when IMAG=.FALSE. or IPOL=.FALSE..

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{QNULL} \sphinxhyphen{} logical flag that regulates the global net charge of a rotating star with poloidal magnetic field.
If QNULL=.TRUE. the code searches for a globally uncharged star, otherwise it minimizes the electric
field at the stellar pole.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{KBTT} \sphinxhyphen{} the value of of \(K_\mathrm{pol}\) in the magnetic law for the case of mixed Twisted Torus configuration.
Never used when IMAG=.FALSE. or ITWT=.FALSE., though it is better set to 0 in this case.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{ATWT} \sphinxhyphen{} the value of a in the magnetic law for the case of mixed Twisted Torus configuration. Never
used when IMAG=.FALSE. or ITWT=.FALSE., though it is better set to 0 in this case.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{ZETA} \sphinxhyphen{} the value of \(\zeta\) in the magnetic law for the case of mixed Twisted Torus configuration.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{CUT} \sphinxhyphen{} the value of \(\lambda\) in the magnetic law for twisted magnetosphere models. It regulates the extension
of the twist. If \(\lambda = 1\) standard Twisted Torus models are recovered.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{NPOL} \sphinxhyphen{} value of the magnetic powerlaw index. Currently it is not used.

\end{itemize}


\section{Initial conditions}
\label{\detokenize{user_params:initial-conditions}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{RHOINI} \sphinxhyphen{} the central density for the starting guess. If the serial flag is used to compile the code, this is also the central density of the final solution. WARNING: if the nwtrps flag is used to compile the code, this is not the central density of the converged model, but its value for the starting guess. By default XNS will search for a solution in the range 0.8\sphinxhyphen{}1.2 RHOINI. If the desired solution is outside this range, XNS will output a warning, and stop.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{QUOC} \sphinxhyphen{} the quantity of interest to which the model must converge {[}0 for a given central density, 1 for
a given gravitational mass, 2 for a given barionic mass{]}.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{QUCONV} \sphinxhyphen{} the value of the quantity of interest to which we want a model to converge. For example if one wants a model with central density 1.28\(\times 10^{−3}\) (in geometrized units) set: QUOC=0, QUCONV=1.28E\sphinxhyphen{}3.

\end{itemize}


\section{Equation of state}
\label{\detokenize{user_params:equation-of-state}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{K1} \sphinxhyphen{} the polytropic coefficient K of the EoS. The code uses a polytropic EoS. The value K1=100 is
for the standard case used for many tests of NS stability and evolution in the literature (see also the
parameter below).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{GAMMA} \sphinxhyphen{} the adiabatic index \(\gamma = 1 + 1/n\) of the polytropic EoS, where \(n\) is the polytropic index. The
value GAMMA=2 (\(n = \)1) is for the standard case used for many tests of NS stability and evolution in
the literature (see also the parameter above).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{CTP} \sphinxhyphen{} if set to .FALSE. the code avoid to use conservative to primitive routines. This flag is effective
only with IPOL=.TRUE..


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{MBARYONFC} \sphinxhyphen{} ratio between a reduced baryon mass and true baryon mass. If equal to 1, it has no effect of the code. In case one wants to find a solution using the SQM2 EoS (tabulated in the SQ2\_resampled.dat file), it is necessary to use MBARYONFC=0.86.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{EOSINT} \sphinxhyphen{} a logical flag to choose whether o use a tabulated or a polytropic EoS. If EOSINT=.TRUE., the EoS tabulated in the file in FILEEOS is used. Otherwise, a polytropic EoS is used.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{FILEEOS} \sphinxhyphen{} specifies the name of the file containing the tabulated EoS that we want to use.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{NPTRHO} \sphinxhyphen{} number of points of the tabulated EoS.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{EOSJOR} \sphinxhyphen{} a logical flag that specifies in which frame of STTs (either Jordan or Einstein) the EoS is computed. If EOSJOR=.TRUE., it is computed in the Jordan frame; otherwise, in the Einstein frame. It should always be set to .FALSE.. Note that, in GR, the two frames coincide, and so this flag has no effect on a GR solution.

\end{itemize}


\section{Scalar field}
\label{\detokenize{user_params:scalar-field}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{ALPHA0} \sphinxhyphen{} value of the \(\alpha _0\) parameter of the scalar coupling function \(\mathcal{A}(\chi)=\exp [ \alpha_0 (\chi - \chi _\mathrm{inf}) + \beta _0 (\chi - \chi _\mathrm{inf})^2 ]\) by Damour, T., \& Esposito\sphinxhyphen{}Farèse, G. (1993). Note that, if set to zero, XNS converges to a GR solution.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{BETA0} \sphinxhyphen{} value of the \(\beta _0\) parameter of the scalar coupling function \(\mathcal{A}(\chi)\).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{CHIINF} \sphinxhyphen{} value of the scalar field at infinity \(\chi _\mathrm{inf}\) in the scalar coupling function \(\mathcal{A}(\chi)\).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{GR} \sphinxhyphen{} a logical flag used to choose whether to compute the solution in GR (if .TRUE.) or in STTs (if .FALSE.). Note that setting GR=.FALSE. together with ALPHA0=0 and BETA0=0 leads to the GR solution anyway.

\end{itemize}


\section{Other}
\label{\detokenize{user_params:other}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{RHOSURF} \sphinxhyphen{} value at which the surface of the NS is set.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{MLS} \sphinxhyphen{} number of spherical harmonics (Legendre polynomials) for spectral decomposition in θ (numbered from 0 to MLS). This should be \(< \)NTH. In 1D (NTH=1) it must be set to 0.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{NGQ} \sphinxhyphen{} the number of interpolation points for the Gauss quadrature, needed to compute the integrals
over the polar direction of the source terms in the spherical harmonics decomposition. Used by all the
2D elliptical PDE solvers. It must be NGQ\$\$NTH. In 1D (NTH=1) it must be set to 1.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{MLSL} \sphinxhyphen{} number of spherical harmonics used to solve the Laplace equation as described in Pili et al.
(2017). This parameter is relevant only in the cases of rotating and poloidal magnetized star.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{ANALYTIC} \sphinxhyphen{} a logical flag. If ANALYTIC=.TRUE., the derivatives of the scalar field in TOVINIMOD are computed using their analytic form; otherwise, a numerical derivative is computed. This option may be used to achieve better convergence of the TOV solution in case one approach is numerically unstable.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{DELTMU0} \sphinxhyphen{} variation \(\Delta \mu _0\) of the central value \(\mu _0\) of \(\mu\) (where \(-e^\mu = g _{00}\) is the \(00\) element of the metric tensor in the TOV metric). It is used to compute the solution at a fixed scalar field in the Newton\sphinxhyphen{}Raphson method in TOVINIMOD. Its value should not be changed.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{MUIN} \sphinxhyphen{} initial guess on \(\mu _0\) in the TOV solution.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{MMID} \sphinxhyphen{} initial guess on the ADM mass of the TOV solution computed in the middle of the grid. At convergence, it must be M\(\sim\)MMID.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{M} \sphinxhyphen{} initial guess on the ADM mass of the TOV solution computed at the outer edge of the grid. At convergence, it must be M\(\sim\)MMID.

\end{itemize}


\chapter{Arrays}
\label{\detokenize{arrays:arrays}}\label{\detokenize{arrays::doc}}
\sphinxAtStartPar
The module system inside the file \sphinxstyleemphasis{SYSTEMXNS.f90} also contains the definitions of some arrays that
are used within the code and shared by many subroutines. We briefly describe some of them here so that the
user can have some idea of what represents what. Other arrays that are specific only to certain subroutines
are defined locally and are not discussed here. Notice that some arrays related to the poloidal components
of the velocity, shift vector, or auxiliary vectors are always zero but still defined in XNS, though related
routines are never called. This is because XNS shares the same metric solver as the full X\sphinxhyphen{}ECHO code.


\section{Grid}
\label{\detokenize{arrays:grid}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{R},\sphinxstylestrong{DR} \sphinxhyphen{} 1D arrays that store the location of the radial points, and the radial increments.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{DRM},\sphinxstylestrong{DRP} \sphinxhyphen{} additional 1D arrays that store the backward and forward radial increments.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{TH},\sphinxstylestrong{DTH},\sphinxstylestrong{XX} \sphinxhyphen{} 1D arrays that store the location of the angular points, the angular increments, and the
cosine of the angle.

\end{itemize}


\section{Metric}
\label{\detokenize{arrays:metric}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{PSI},\sphinxstylestrong{PSL},\sphinxstylestrong{PSS},\sphinxstylestrong{PSSR},\sphinxstylestrong{PSST} \sphinxhyphen{} 2D arrays of metric terms, respectively \(\psi\), \(\alpha \psi\), \(X^{\phi}\), \(X^{r}\), \(X^{\theta}\). We have either \(X^i=W^i\), or \(X^i ≡ \beta ^i\), depending on the step of the metric solver.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{CURVC},\sphinxstylestrong{CURVR},\sphinxstylestrong{CURVT},\sphinxstylestrong{CURVP} \sphinxhyphen{} 2D arrays containing the source terms associated with the curvature
of the metric, respectively for the two scalar Poisson equations (for \(\psi\) and \(\alpha\)) and for the three
components of the second vector Poisson equation (that for \(\beta ^i\)).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{MU},\sphinxstylestrong{NU} \sphinxhyphen{} 1D arrays containing the metric terms of the radial TOV solution. The metric employed is
that for isotropic coordinates, namely \(ds^2 = -e^\nu dt^2 + e^\mu (dr^2 + r^2 d\theta ^2 + r^2 \sin ^2 \theta d\phi ^2)\).

\end{itemize}


\section{MHD}
\label{\detokenize{arrays:mhd}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{RHOSRC},\sphinxstylestrong{ESRC},\sphinxstylestrong{PSRC},\sphinxstylestrong{VPHI},\sphinxstylestrong{VR},\sphinxstylestrong{VTH},\sphinxstylestrong{BPHI},\sphinxstylestrong{SSS} \sphinxhyphen{} 2D arrays, respectively \(\rho\), \(\rho h = \rho (1 + \varepsilon) + p\), \(p\), \(v^\phi\), \(v^r\), \(v^\theta\), \(B^\phi\), \(S\), needed for the source terms.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{RHOTV},\sphinxstylestrong{PRTV},\sphinxstylestrong{ETV} \sphinxhyphen{} 1D arrays containing the fluid variables of the radial TOV solution, respectively
\(\rho\), \(p\), \(\rho \varepsilon\).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{RHONEW},\sphinxstylestrong{PNEW},\sphinxstylestrong{ENEW},\sphinxstylestrong{V3NEW},\sphinxstylestrong{B3NEW},\sphinxstylestrong{E3NEW} \sphinxhyphen{} 2D arrays, respectively \(\rho\), \(p\), \(\rho \varepsilon\), \(v^\phi\), \(B^\phi\), \(E_\phi\) computed for an equilibrium configuration on the metric at the end of each step of the convergence loop.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{BPOLR},\sphinxstylestrong{BPOLT},\sphinxstylestrong{EPOLR},\sphinxstylestrong{EPOLT},\sphinxstylestrong{APHI},\sphinxstylestrong{ATIM} \sphinxhyphen{} 2D arrays, respectively, \(B^r\), \(B^\theta\), \(E_r\), \(E_\theta\), \(\tilde A ^\phi = \Phi\), \(A^t = \Psi\) for the magnetic configuration with poloidal field components.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{RHOTVJOR},\sphinxstylestrong{PRTVJOR},\sphinxstylestrong{ETVJOR} \sphinxhyphen{} 1D arrays, respectively \(\rho\), \(p\), \(\rho \varepsilon\) of the TOV solution computed in the Jordan frame. Note that, in GR, these are equal to RHOTV, PRTV, ETV respectively.

\end{itemize}


\section{Scalar field}
\label{\detokenize{arrays:scalar-field}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{CHITV},\sphinxstylestrong{DCHITV},\sphinxstylestrong{DDCHITV} \sphinxhyphen{} 1D arrays, respectively \(\chi\), \(\partial _r \chi\), \(\partial ^2 _r \chi\) of the TOV solution.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{CHI} \sphinxhyphen{} 2D array containing the scalar field \(\chi\).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{PSCAL},\sphinxstylestrong{QSCALTIM},\sphinxstylestrong{QSCALR},\sphinxstylestrong{QSCALT},\sphinxstylestrong{QSCALP},\sphinxstylestrong{QSCAL2} \sphinxhyphen{} 2D arrays, containing the 3+1 decomposition of the scalar field derivative. These are respectively \(P\), \(Q^\mu\) and \(Q_\mu Q^\mu\) of Eq. 26 in SBD20.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{ASCAL} \sphinxhyphen{} 2D array, containing the scalar coupling function \(\mathcal{A}(\chi)\).

\end{itemize}


\section{Source terms}
\label{\detokenize{arrays:source-terms}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{USRC},\sphinxstylestrong{DSRC},\sphinxstylestrong{S3SRC},\sphinxstylestrong{S1SRC},\sphinxstylestrong{S2SRC} \sphinxhyphen{} 2D arrays containing the U conservative variables needed for
the source terms, respectively \(\hat E\), \(\hat D\) , \(\hat S _\phi\) , \(\hat S _r\), \(\hat S _\theta\), all multiplied by \(f ^{1/2} = r^2 \sin \theta\).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{USRCX},\sphinxstylestrong{S3SRCX},\sphinxstylestrong{S1SRCX},\sphinxstylestrong{S2SRCX} \sphinxhyphen{} 2D arrays containing the U conservative variables associated to the scalar field, needed for the source terms, respectively \(\hat E\), \(\hat D\) , \(\hat S _\phi\) , \(\hat S _r\), \(\hat S _\theta\), all multiplied by \(f ^{1/2} = r^2 \sin \theta\).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{ECSRC},\sphinxstylestrong{ELSRC},\sphinxstylestrong{ES1RC},\sphinxstylestrong{ES2RC},\sphinxstylestrong{ES3RC} \sphinxhyphen{} 2D arrays containing the source terms (the right hand side of
the equations) associated with the presence of matter in the elliptic PDEs. Respectively, the source
for the equations for \(\psi\), \(\alpha \psi\), \(X^{\phi}\), \(X^{r}\), \(X^{\theta}\), where \(X^i=W^i\), or \(X^i ≡ \beta ^i\).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{TRACEM} \sphinxhyphen{} 2D array containing the trace of the energy\sphinxhyphen{}momentum tensor of matter, used for the source of the equation of the scalar field.

\end{itemize}


\chapter{Files and outputs}
\label{\detokenize{files_outputs:files-and-outputs}}\label{\detokenize{files_outputs::doc}}
\sphinxAtStartPar
Here is a list of all the files and subroutines included int the XNS package, together with a brief
description of what they do and how they operates. We start with the Fortran 90 files of the code (with
extension \sphinxstyleemphasis{.f90}), then we describe the output files produced by a run (with extension \sphinxstyleemphasis{.dat}), and we conclude
with the Python 3 files needed for visualisation (with extension \sphinxstyleemphasis{.py} or \sphinxstyleemphasis{.ipynb}, for use in Jupyter). The code
must run in double precision for convergence. The \sphinxstyleemphasis{makefile} is provided for the gfortran (GNU) compiler. For more
info on the compilation of XNS, see section “Compiling XNS”.


\section{Files}
\label{\detokenize{files_outputs:files}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{XNS.f90} \sphinxhyphen{} main program. Makes some consistency checks, and invokes XNSMAIN. Depending on
the pre\sphinxhyphen{}compiling option it simply calls XNSMAIN (if make serial is used to compile the code), or it
performs a Newton\sphinxhyphen{}Raphson search for an equilibrium model with a given value for a desired quantity
of interest, i.e. a certain value of the central density or gravitational mass (if make nwtrps is used). Moreover, it can compute many models in parallel with different initial conditions (if make parspace is used).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{XNSMAIN.f90}
\begin{itemize}
\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{XNSMAIN} \sphinxhyphen{} the main kernel of the code: it defines the grid, builds a 2D initial guess based on the 1D TOV output of TOVINIMOD.f90, performs the convergence loop calling all the various metric solvers and procedures in the appropriate order. When the loop is over, it writes all the outputs.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{CONFORMAL} \sphinxhyphen{} solves for the scalar Poisson\sphinxhyphen{}like equation for \(\psi\).

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{LAPSE} \sphinxhyphen{} solves for the scalar Poisson\sphinxhyphen{}like equation for \(\alpha \psi\).

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{SHIFTPHI} \sphinxhyphen{} solves the \(\phi\) component of the two vector Poisson equations for \(W^i\) and \(\beta ^i\), given the corresponding source terms.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{CURV1} \sphinxhyphen{} computes the curvature source term in the routines for \(\psi\) and \(\alpha \psi\).

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{CURV2} \sphinxhyphen{} computes the curvature source term in the routine for \(\beta ^\phi\).

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{SOURCECHI} \sphinxhyphen{} computes the metric terms and derivatives used in the source terms of the equation for \(\chi\).

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{SOLVECHI} \sphinxhyphen{} solves for the scalar field equation for \(\chi\), given the source term. Note that since \(\chi\) also appears in the source term, a single call of SOLVECHI won’t yield a true solution.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{CHISOL} \sphinxhyphen{} wrapper that calls SOURCECHI and CHISOL in a relaxation loop, until it converges to the true solution.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{CHIDERIVS} \sphinxhyphen{} computes the derivatives of the scalar field (\(Q^\mu\)) and the scalar coupling function \(\mathcal{A}(\chi)\).


\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{SYSTEM.f90}
\begin{itemize}
\item {} 
\sphinxAtStartPar
module \sphinxstylestrong{SYSTEM} \sphinxhyphen{} contains various parameters of the run, to be specified by the user, and definitions of common arrays (see section “User parameters”).

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{EOSTABLEREAD} \sphinxhyphen{} reads the EoS file specified by the FILEEOS parameter. Note that the first line in the file must be the number of points present in the file, and this must be equal to the parameter NPTRHO. The subsequent lines must contain the minimum and maximum density and their indexes (second line), the minimum and maximum pressure and their indexes (third line), the minimum and maximum internal energy and their indexes (fourth line), the minimum and maximum enthalpy and their indexes (fifth line). Then, the table is read. Please, refer to the routine code to see the specific structure that the EoS file must have.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{RHO2EOS} \sphinxhyphen{} given \(\rho\), it computes the pressure \(p\), the internal energy \(\varepsilon\) and the enthalpy \(h\) according to the tabulated EoS.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{PRS2EOS} \sphinxhyphen{} given \(p\), it computes the \(\rho\) according to the tabulated EoS.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{ENT2EOS} \sphinxhyphen{} given \(h\), it computes the \(\rho\) according to the tabulated EoS.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{EOS} \sphinxhyphen{} computes the density and the internal energy given the pressure, both in case the EoS is tabulated or an analytical polytropic.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{FUNCD\_EOS} \sphinxhyphen{} used by the root\sphinxhyphen{}finding subroutine to derive the central pressure given
the central density.


\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{HYDROEQ.f90}
\begin{itemize}
\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{HYDROEQ} \sphinxhyphen{} given the CFC metric and a value of \(\rho _\mathrm{c}\) it computes the equilibrium
configuration for the corresponding Bernoulli integral. It finally calls
hydrovar\_ depending on the physical parameter set in SYSTEMXNS.f90 to compute local
equilibrium quantities.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{HYDROVAR}, \sphinxstylestrong{HYDROVAR\_TOR}, \sphinxstylestrong{HYDROVAR\_POL} \sphinxhyphen{} they compute local equilibrium
quantities such as \(\rho\), \(p\), \(v^\phi\), \(B^i\) and \(E_i\) depending on the specific choice for the magnetization (respectively unmagnetized case, purely toroidal magnetic field and poloidal magnetic field).

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{COVTERM} \sphinxhyphen{} computes the local terms of the metric tensor

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{CONS\_TO\_PRIM} \sphinxhyphen{} computes the inversion from conserved to primitive variables.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{CONS\_TO\_PRIM\_POL} \sphinxhyphen{} computes the inversion from conserved to primitive variables for the specific case of poloidal field.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{QUANTITIES} \sphinxhyphen{} computes several quantities (e.g. mass, energy, angular momentum, scalar charge, magnetic deformation) at the end of the convergence loop, according to standard definitions. See also SDB20 for some definitions in the case of STTs.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{SOURCEPOT} \sphinxhyphen{} compute source terms (currents and metric) for the Grad\sphinxhyphen{}Shafranov
Equation or Maxwell equations depending if the rotational rate OMG is set to zero or not.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{VECPOTPHI} \sphinxhyphen{} called by the subroutine hydrovar\_pol when OMG.EQ.0, it solves
the Grad\sphinxhyphen{}Shafranov Equation.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{MXWLSOL} \sphinxhyphen{} called by subroutine hydrovar\_pol when OMG.NE.0, it solves iteratively the Maxwell\sphinxhyphen{}Ampere and the Maxwell\sphinxhyphen{}Gauss equation. It finally corrects the solution for the electric potential \(\Phi\) in order to guarantee that the MHD condition \(\Phi = -\Omega \Psi + C\) is valid
inside the star. Indeed, as explained in Pili et al. (2017), the solution for \(\Phi\) obtained by solving
the non\sphinxhyphen{}homogeneus Maxwell equations, does not satisfy the perfect conducting relation inside
the star, but differs from the MHD solution solution \(\Phi _\mathrm{MHD} = -\Omega \Psi + C\) by an harmonic function
\(\Phi _\mathrm{a}\) so that \(\Phi = \Phi _\mathrm{MHD} + \Phi _\mathrm{a}\) with \(\Delta \Phi _\mathrm{a} = 0\). The harmonic function is obtained evoking the laplace subroutine.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{SOLVEAPHI} and subroutine \sphinxstylestrong{SOLVEATIME} \sphinxhyphen{} solve respectively for the Maxwell\sphinxhyphen{}Ampere and Maxwell\sphinxhyphen{}Gauss equations.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{LAPLACE} \sphinxhyphen{} solves the equations \(\Phi _\mathrm{a} \big |_{S _\mathrm{NS}} = \Sigma _l Y(\theta) (a_l r^l) |_{S _\mathrm{NS}}\) (inside the star) and \(\Phi _\mathrm{a} \big |_{S _\mathrm{NS}} = \Sigma _l Y(\theta) (b_l r^{-(l+1)}) |_{S _\mathrm{NS}}\) (outside the star), where \(S _\mathrm{NS}\) is stellar surface and \(\Phi _\mathrm{a} \big |_{S _\mathrm{NS}} = (\Phi + \Omega \Psi + C) |_{S _\mathrm{NS}}\). Each system of equations is solved with a LU decomposition and a subsequent backward substitution adopting the routines provided in the Numerical Recipes (ludcmp and
lubksb). Notice that, in order to avoid spurious effects, the surface terms are evaluated on top
of the super\sphinxhyphen{}ellipsoid that best fit the numerical surface.


\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{ROTATION.f90}
\begin{itemize}
\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{CHECKROTDIFF} \sphinxhyphen{} ?

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{OMEGAVALUE} \sphinxhyphen{} derives the function \(\Omega = \Omega (r,\theta)\) for the differential rotation.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{OMEGA3LVALUE} \sphinxhyphen{} ?

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{FODFO\_OS} \sphinxhyphen{} ?

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{A3L\_OS} \sphinxhyphen{} ?

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{PARS\_VALUE\_JS} \sphinxhyphen{} ?

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{FODFO\_JS} \sphinxhyphen{} ?

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{A3L\_JS} \sphinxhyphen{} ?


\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{TOVINIMOD.f90}
\begin{itemize}
\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{TOVINIMOD} \sphinxhyphen{} solves the 1D TOV (either in GR or in STTs) equations in isotropic coordinates to provide the initial guess. It uses a relaxation method to achieve convergence.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{EXPANSION} \sphinxhyphen{} a Taylor expansion of the TOV equations at small initial radii (they are
singular for \(r \rightarrow 0\)).

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{TOVEQS} \sphinxhyphen{} provides the derivatives needed to integrate the TOV equations via the
RK4 method.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{RK4} \sphinxhyphen{} the 4th order RK integrator (modified from the Numerical Recipes).

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{MASSFIND} \sphinxhyphen{} computes the ADM mass of the scalarised TOV solution at a given radius (either at the middle of the grid or at its outer edge) by knowing the scalar charge and the value of \(\mu\) at that point. It is used in order to achieve convergence, as explained in SBD20 Appendix B.


\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{PHYSICS.f90}
\begin{itemize}
\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{GRIDBUILD} \sphinxhyphen{} computes the radial grid (either uniform or stretched) and derivative terms used in the DGTSV subroutine.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{FUNCD\_STRETCH} \sphinxhyphen{} used by the root\sphinxhyphen{}finding subroutine to derive the stretching factor for the grid, if it is stretched.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{FUNCTIONS.f90}
\begin{itemize}
\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{DGTSV} \sphinxhyphen{} solves the linear system \(AX = B\), where \(A\) is a tridiagonal matrix, by
Gaussian elimination with partial pivoting (taken from the LAPACK routines).

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{LUSOLVER} \sphinxhyphen{} solves the linear system \(AX = B\), where \(A\) is an \(N \times N\) matrix and \(B\) is a vector of length \(N\), with an LU decomposition.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{MYSWAP} \sphinxhyphen{} ?

\item {} 
\sphinxAtStartPar
function \sphinxstylestrong{MYISAMAX} \sphinxhyphen{} ?

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{SGER} \sphinxhyphen{} ?

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{SLASWP} \sphinxhyphen{} ?

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{LAGRANGEINT} \sphinxhyphen{} ?

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{LAGRANGEINT2D} \sphinxhyphen{} ?

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{LEGZO} \sphinxhyphen{} computes the zeros of Legendre polynomials and the corresponding
weights for Gaussian quadrature integration.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{LPN} \sphinxhyphen{} computes the Legendre polynomials and their derivatives.

\item {} 
\sphinxAtStartPar
subroutine \sphinxstylestrong{POLINT} \sphinxhyphen{} a polynomial 2nd order interpolation routine (modified from the Numerical Recipes).

\end{itemize}

\end{itemize}

\end{itemize}


\section{Outputs}
\label{\detokenize{files_outputs:outputs}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Grid.dat} \sphinxhyphen{} contains the grid mesh points.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{TOVINIMOD\_PROFILES.dat} \sphinxhyphen{} contains the 1D TOV solution \((r,\mu,\rho,\nu,p,\rho\varepsilon,\chi)\).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Source.dat} \sphinxhyphen{} contains 2D source term for the metric solver \((\rho,p,\rho\varepsilon)\).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{XShiftphi.dat} \sphinxhyphen{} contains the \(W^\phi\) component and the related source term of its vector Poisson
equation.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Conformal.dat} \sphinxhyphen{} contains \(\psi\) and the two (matter and curvature) source terms of its scalar Poisson
equation.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Primitive.dat} \sphinxhyphen{} contains the primitive variables \((\rho,p,\rho\varepsilon,v^\phi,B^\phi)\) recovered self\sphinxhyphen{}consistently from
the metric and the conserved variables.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Primitive\_mag.dat} \sphinxhyphen{} contains the magnetic primitive variables \((B^\phi,B^r,B^\theta)\) recovered self\sphinxhyphen{}consistently
from the metric and the conserved variables.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Lapse.dat} \sphinxhyphen{} contains \(\alpha\) and the two (matter and curvature) source terms of the related scalar Poisson
equation.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Shiftphi.dat} \sphinxhyphen{} \(\beta ^\phi\) vector and the related source term of the vector Poisson equation.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Chi.dat} \sphinxhyphen{} \(\chi\) and the related source term of the scalar field equation.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Hydroeq.dat} \sphinxhyphen{} contains the new equilibrium configuration \((\rho,p,\psi,v^\phi,\alpha,\beta^\phi,\chi,Q^r,Q^t)\).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Hydroeq\_mag.dat} \sphinxhyphen{} contains the new equilibrium configuration for magnetic field \((B^\phi,B^r,B^\theta,\tilde A ^\phi,E_\phi,E_r,E_\theta,A^t,J^\phi,J^r,J^\theta)\).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Mxwll\_test.dat} \sphinxhyphen{} cointains data related to the source term of both Maxwell\sphinxhyphen{}Ampere and Maxwell\sphinxhyphen{}Gauss equation \((\rho _\mathrm{e},J^\phi,\Phi _\mathrm{int},\Phi _\mathrm{ext},\Phi _\mathrm{a},\omega,\Gamma)\).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Apconv.dat} \sphinxhyphen{} maximum value of \(\Psi\) at each step of the XNSMAIN subroutine.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Atconv.dat} \sphinxhyphen{} maximum value of \(\Phi\) at each step of the XNSMAIN subroutine.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Chiconv.dat} \sphinxhyphen{} maximum value of \(\chi\) at each step of the XNSMAIN subroutine.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Rhovec.dat} \sphinxhyphen{} central density and other quantities at each step of the XNSMAIN subroutine. It is used to check convergence.


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Surf.dat} \sphinxhyphen{} contains the radius of the NS surface at all angles \(\theta\).


\item {} 
\sphinxAtStartPar
\sphinxstylestrong{LogFile.dat} \sphinxhyphen{} summary of the run (input and output quantities).

\end{itemize}


\section{Visualisation}
\label{\detokenize{files_outputs:visualisation}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{starplot\_polo.py} \sphinxhyphen{} plots a section of the star in the \(x-z\) plane along with the contours of either the poloidal magnetic field (with or without the field lines), the scalar field or the density.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{starplot\_toro.py} \sphinxhyphen{} plots a section of the star in the \(x-z\) plane along with the contours of either the toroidal magnetic field, the scalar field or the density.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{starplot\_unmag.py} \sphinxhyphen{} plots a section of the star in the \(x-z\) plane along with the contours of either the scalar field or the density.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{profile\_polo.py} \sphinxhyphen{} plots the radial profiles, both at the pole and at the equator, of several quantities: \(\rho\), \(p\), \(\psi\), \(\alpha\), \(\chi\), \(B_\mathrm{pol}\).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{profile\_toro.py} \sphinxhyphen{} plots the radial profiles, both at the pole and at the equator, of several quantities: \(\rho\), \(p\), \(\psi\), \(\alpha\), \(\chi\), \(B_\mathrm{tor}\).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{profile\_unmag.py} \sphinxhyphen{} plots the radial profiles, both at the pole and at the equator, of several quantities: \(\rho\), \(p\), \(\psi\), \(\alpha\), \(\chi\).

\end{itemize}


\chapter{Examples in GR}
\label{\detokenize{examples_gr:examples-in-gr}}\label{\detokenize{examples_gr::doc}}
\sphinxAtStartPar
Here we present a few examples to show how to work with the code and the related performances. All
cases have been run on a simple laptop


\section{Rotating, unmagnetised NS in GR with the ??? EoS}
\label{\detokenize{examples_gr:rotating-unmagnetised-ns-in-gr-with-the-eos}}
\sphinxAtStartPar
Description.

\sphinxAtStartPar
Here are the main parameters used to compute this model. The detailed log with all the parameters can be found in the corresponding LogFile.dat.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{PARAM1} \PYG{o}{=} \PYG{n}{VALUE1}\PYG{p}{,} \PYG{n}{PARAM2} \PYG{o}{=} \PYG{n}{VALUE2}\PYG{p}{,} \PYG{n}{PARAM3} \PYG{o}{=} \PYG{n}{VALUE3}\PYG{p}{,} \PYG{n}{PARAM4} \PYG{o}{=} \PYG{n}{VALUE4}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}
\end{sphinxVerbatim}


\section{Rotating, magnetised NS in GR with the ??? EoS}
\label{\detokenize{examples_gr:rotating-magnetised-ns-in-gr-with-the-eos}}
\sphinxAtStartPar
Description.

\sphinxAtStartPar
Here are the main parameters used to compute this model. The detailed log with all the parameters can be found in the corresponding LogFile.dat.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{PARAM1} \PYG{o}{=} \PYG{n}{VALUE1}\PYG{p}{,} \PYG{n}{PARAM2} \PYG{o}{=} \PYG{n}{VALUE2}\PYG{p}{,} \PYG{n}{PARAM3} \PYG{o}{=} \PYG{n}{VALUE3}\PYG{p}{,} \PYG{n}{PARAM4} \PYG{o}{=} \PYG{n}{VALUE4}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}
\end{sphinxVerbatim}


\chapter{Examples in STTs}
\label{\detokenize{examples_stt:examples-in-stts}}\label{\detokenize{examples_stt::doc}}
\sphinxAtStartPar
Here we present a few examples to show how to work with the code and the related performances. All
cases have been run on a laptop.


\section{Non\sphinxhyphen{}rotating, unmagnetised NS in STT with the APR EoS}
\label{\detokenize{examples_stt:non-rotating-unmagnetised-ns-in-stt-with-the-apr-eos}}
\sphinxAtStartPar
This is a model of an unmagnetised NS in STTs with \(\alpha _0 = -2.0\times 10^{-4}\) and \(\beta _0 = -6\) described by the APR EoS. It has a J\sphinxhyphen{}frame central density \(\rho _\mathrm{c}=1.4\times 10^{-3}\) in code units (corresponding to \(8.684\times 10^{14}\) gcm\(^{-3}\)) and a Komar mass in the E\sphinxhyphen{}frame of \(1.086\) M\( _\odot\). The circumferential radius in the J\sphinxhyphen{}frame is \(10.963\) km, and the E\sphinxhyphen{}frame scalar charge is \(0.532\) M\( _\odot\).

\sphinxAtStartPar
Here are the main parameters used to compute this model. The detailed log with all the parameters can be found in the corresponding LogFile.dat.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{NR} \PYG{o}{=} \PYG{l+m+mi}{900}\PYG{p}{,} \PYG{n}{NTH} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{NRREG} \PYG{o}{=} \PYG{l+m+mi}{600}\PYG{p}{,} \PYG{n}{MLS} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{NGQ} \PYG{o}{=} \PYG{l+m+mi}{50}\PYG{p}{,} \PYG{n}{RREG} \PYG{o}{=} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{RMAXSTR} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,}
\PYG{n}{RMAX} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{REQMAX} \PYG{o}{=} \PYG{l+m+mf}{11.50}\PYG{p}{,} \PYG{n}{RHOINI} \PYG{o}{=} \PYG{l+m+mf}{1.40E\PYGZhy{}3}\PYG{p}{,} \PYG{n}{ALPHA0} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.0E\PYGZhy{}4}\PYG{p}{,} \PYG{n}{BETA0} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{6}\PYG{p}{,} \PYG{n}{GR} \PYG{o}{=} \PYG{o}{.}\PYG{n}{FALSE}\PYG{o}{.}\PYG{p}{,}
\PYG{n}{STRETCH} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{ANALYTIC} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{CONVHELP} \PYG{o}{=} \PYG{o}{.}\PYG{n}{FALSE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{QFACTOR} \PYG{o}{=} \PYG{l+m+mf}{0.85}\PYG{p}{,} \PYG{n}{QFACTORCHI} \PYG{o}{=} \PYG{l+m+mf}{0.45}\PYG{p}{,}
\PYG{n}{QFACTORMETRIC} \PYG{o}{=} \PYG{l+m+mf}{0.35}\PYG{p}{,} \PYG{n}{QRELAX} \PYG{o}{=} \PYG{l+m+mf}{0.30}\PYG{p}{,} \PYG{n}{QAPHI} \PYG{o}{=} \PYG{l+m+mf}{0.50}\PYG{p}{,} \PYG{n}{EOSINT} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{FILEEOS} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{APR\PYGZus{}resampled.dat}\PYG{l+s+s1}{\PYGZsq{}}
\end{sphinxVerbatim}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{starplot_rho_b-6_unmag}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Section of the NS in the \(x-z\) plane along with the contours the density.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{starplot_chi_b-6_unmag}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Section of the NS in the \(x-z\) plane along with the contours the scalar field.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{rho_b-6_unmag}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the NS density at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{p_b-6_unmag}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the NS pressure at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{chi_b-6_unmag}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the scalar field at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{alpha_b-6_unmag}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the lapse function at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{psi_b-6_unmag}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the conformal factor at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\section{Non\sphinxhyphen{}rotating NS in STT with the APR EoS and a purely poloidal magnetic field}
\label{\detokenize{examples_stt:non-rotating-ns-in-stt-with-the-apr-eos-and-a-purely-poloidal-magnetic-field}}
\sphinxAtStartPar
This is a model of an NS in STTs with \(\alpha _0 = -2.0\times 10^{-4}\) and \(\beta _0 = -6\) described by the APR EoS, endowed with a purely poloidal field. It has a J\sphinxhyphen{}frame central density \(\rho _\mathrm{c}=1.4\times 10^{-3}\) in code units (corresponding to \(8.684\times 10^{14}\) gcm\(^{-3}\)) and a Komar mass in the E\sphinxhyphen{}frame of \(1.098\) M\( _\odot\). The circumferential radius in the J\sphinxhyphen{}frame is \(11.072\) km, and the E\sphinxhyphen{}frame scalar charge is \(0.551\) M\( _\odot\).

\sphinxAtStartPar
Here are the main parameters used to compute this model. The detailed log with all the parameters can be found in the corresponding LogFile.dat.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{NR} \PYG{o}{=} \PYG{l+m+mi}{900}\PYG{p}{,} \PYG{n}{NTH} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{NRREG} \PYG{o}{=} \PYG{l+m+mi}{600}\PYG{p}{,} \PYG{n}{MLS} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{NGQ} \PYG{o}{=} \PYG{l+m+mi}{50}\PYG{p}{,} \PYG{n}{RREG} \PYG{o}{=} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{RMAXSTR} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,}
\PYG{n}{RMAX} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{REQMAX} \PYG{o}{=} \PYG{l+m+mf}{11.50}\PYG{p}{,} \PYG{n}{RHOINI} \PYG{o}{=} \PYG{l+m+mf}{1.40E\PYGZhy{}3}\PYG{p}{,} \PYG{n}{ALPHA0} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.0E\PYGZhy{}4}\PYG{p}{,} \PYG{n}{BETA0} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{6}\PYG{p}{,} \PYG{n}{GR} \PYG{o}{=} \PYG{o}{.}\PYG{n}{FALSE}\PYG{o}{.}\PYG{p}{,}
\PYG{n}{STRETCH} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{ANALYTIC} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{CONVHELP} \PYG{o}{=} \PYG{o}{.}\PYG{n}{FALSE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{QFACTOR} \PYG{o}{=} \PYG{l+m+mf}{0.85}\PYG{p}{,} \PYG{n}{QFACTORCHI} \PYG{o}{=} \PYG{l+m+mf}{0.45}\PYG{p}{,}
\PYG{n}{QFACTORMETRIC} \PYG{o}{=} \PYG{l+m+mf}{0.35}\PYG{p}{,} \PYG{n}{QRELAX} \PYG{o}{=} \PYG{l+m+mf}{0.30}\PYG{p}{,} \PYG{n}{QAPHI} \PYG{o}{=} \PYG{l+m+mf}{0.50}\PYG{p}{,} \PYG{n}{EOSINT} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{FILEEOS} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{APR\PYGZus{}resampled.dat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{n}{IMAG} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{IPOL} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{KBPOL} \PYG{o}{=} \PYG{l+m+mf}{0.2}\PYG{p}{,} \PYG{n}{NPOL} \PYG{o}{=} \PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{n}{CSI} \PYG{o}{=} \PYG{l+m+mf}{0.0}
\end{sphinxVerbatim}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{starplot_rho_b-6_polo}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Section of the NS in the \(x-z\) plane along with the contours the density.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{starplot_chi_b-6_polo}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Section of the NS in the \(x-z\) plane along with the contours the scalar field.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{starplot_b_b-6_polo}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Section of the NS in the \(x-z\) plane along with the contours the poloidal magnetic field strength and its field lines.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{rho_b-6_polo}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the NS density at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{p_b-6_polo}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the NS pressure at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{chi_b-6_polo}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the scalar field at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{alpha_b-6_polo}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the lapse function at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{psi_b-6_polo}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the conformal factor at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{bpol_b-6_polo}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the poloidal magnetic field strength at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\section{Non\sphinxhyphen{}rotating NS in STT with the APR EoS and a purely toroidal magnetic field}
\label{\detokenize{examples_stt:non-rotating-ns-in-stt-with-the-apr-eos-and-a-purely-toroidal-magnetic-field}}
\sphinxAtStartPar
This is a model of an NS in STTs with \(\alpha _0 = -2.0\times 10^{-4}\) and \(\beta _0 = -6\) described by the APR EoS, endowed with a purely toroidal field. It has a J\sphinxhyphen{}frame central density \(\rho _\mathrm{c}=1.4\times 10^{-3}\) in code units (corresponding to \(8.684\times 10^{14}\) gcm\(^{-3}\)) and a Komar mass in the E\sphinxhyphen{}frame of \(1.078\) M\( _\odot\). The circumferential radius in the J\sphinxhyphen{}frame is \(11.060\) km, and the E\sphinxhyphen{}frame scalar charge is \(0.515\) M\( _\odot\).

\sphinxAtStartPar
Here are the main parameters used to compute this model. The detailed log with all the parameters can be found in the corresponding LogFile.dat.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{NR} \PYG{o}{=} \PYG{l+m+mi}{900}\PYG{p}{,} \PYG{n}{NTH} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{NRREG} \PYG{o}{=} \PYG{l+m+mi}{600}\PYG{p}{,} \PYG{n}{MLS} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{NGQ} \PYG{o}{=} \PYG{l+m+mi}{50}\PYG{p}{,} \PYG{n}{RREG} \PYG{o}{=} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{RMAXSTR} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,}
\PYG{n}{RMAX} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{REQMAX} \PYG{o}{=} \PYG{l+m+mf}{11.50}\PYG{p}{,} \PYG{n}{RHOINI} \PYG{o}{=} \PYG{l+m+mf}{1.40E\PYGZhy{}3}\PYG{p}{,} \PYG{n}{ALPHA0} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.0E\PYGZhy{}4}\PYG{p}{,} \PYG{n}{BETA0} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{6}\PYG{p}{,} \PYG{n}{GR} \PYG{o}{=} \PYG{o}{.}\PYG{n}{FALSE}\PYG{o}{.}\PYG{p}{,}
\PYG{n}{STRETCH} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{ANALYTIC} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{CONVHELP} \PYG{o}{=} \PYG{o}{.}\PYG{n}{FALSE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{QFACTOR} \PYG{o}{=} \PYG{l+m+mf}{0.85}\PYG{p}{,} \PYG{n}{QFACTORCHI} \PYG{o}{=} \PYG{l+m+mf}{0.45}\PYG{p}{,}
\PYG{n}{QFACTORMETRIC} \PYG{o}{=} \PYG{l+m+mf}{0.35}\PYG{p}{,} \PYG{n}{QRELAX} \PYG{o}{=} \PYG{l+m+mf}{0.30}\PYG{p}{,} \PYG{n}{QAPHI} \PYG{o}{=} \PYG{l+m+mf}{0.50}\PYG{p}{,} \PYG{n}{EOSINT} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{FILEEOS} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{APR\PYGZus{}resampled.dat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{n}{IMAG} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{ITOR} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{KBPOL} \PYG{o}{=} \PYG{l+m+mf}{0.7}\PYG{p}{,} \PYG{n}{NPOL} \PYG{o}{=} \PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{n}{CSI} \PYG{o}{=} \PYG{l+m+mf}{0.0}
\end{sphinxVerbatim}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{starplot_rho_b-6_toro}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Section of the NS in the \(x-z\) plane along with the contours the density.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{starplot_chi_b-6_toro}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Section of the NS in the \(x-z\) plane along with the contours the scalar field.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{starplot_b_b-6_toro}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Section of the NS in the \(x-z\) plane along with the contours the toroidal magnetic field strength.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{rho_b-6_toro}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the NS density at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{p_b-6_toro}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the NS pressure at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{chi_b-6_toro}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the scalar field at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{alpha_b-6_toro}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the lapse function at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{psi_b-6_toro}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the conformal factor at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{btor_b-6_toro}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the toroidal magnetic field strength at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\section{Non\sphinxhyphen{}rotating, unmagnetised NS in STT with the POL2 EoS}
\label{\detokenize{examples_stt:non-rotating-unmagnetised-ns-in-stt-with-the-pol2-eos}}
\sphinxAtStartPar
This is a model of an unmagnetised NS in STTs with \(\alpha _0 = -2.0\times 10^{-4}\) and \(\beta _0 = -6\) described by the analytic POL2 EoS. It has a J\sphinxhyphen{}frame central density \(\rho _\mathrm{c}=1.36\times 10^{-3}\) in code units (corresponding to \(8.44\times 10^{14}\) gcm\(^{-3}\)) and a Komar mass in the E\sphinxhyphen{}frame of \(1.296\) M\( _\odot\). The circumferential radius in the J\sphinxhyphen{}frame is \(14.156\) km, and the E\sphinxhyphen{}frame scalar charge is \(0.645\) M\( _\odot\).

\sphinxAtStartPar
Here are the main parameters used to compute this model. The detailed log with all the parameters can be found in the corresponding LogFile.dat.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{NR} \PYG{o}{=} \PYG{l+m+mi}{900}\PYG{p}{,} \PYG{n}{NTH} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{NRREG} \PYG{o}{=} \PYG{l+m+mi}{600}\PYG{p}{,} \PYG{n}{MLS} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{NGQ} \PYG{o}{=} \PYG{l+m+mi}{50}\PYG{p}{,} \PYG{n}{RREG} \PYG{o}{=} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{RMAXSTR} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,}
\PYG{n}{RMAX} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{REQMAX} \PYG{o}{=} \PYG{l+m+mf}{15.0}\PYG{p}{,} \PYG{n}{RHOINI} \PYG{o}{=} \PYG{l+m+mf}{1.36E\PYGZhy{}3}\PYG{p}{,} \PYG{n}{ALPHA0} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.0E\PYGZhy{}4}\PYG{p}{,} \PYG{n}{BETA0} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{6}\PYG{p}{,} \PYG{n}{GR} \PYG{o}{=} \PYG{o}{.}\PYG{n}{FALSE}\PYG{o}{.}\PYG{p}{,}
\PYG{n}{STRETCH} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{ANALYTIC} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{CONVHELP} \PYG{o}{=} \PYG{o}{.}\PYG{n}{FALSE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{QFACTOR} \PYG{o}{=} \PYG{l+m+mf}{0.85}\PYG{p}{,} \PYG{n}{QFACTORCHI} \PYG{o}{=} \PYG{l+m+mf}{0.45}\PYG{p}{,}
\PYG{n}{QFACTORMETRIC} \PYG{o}{=} \PYG{l+m+mf}{0.35}\PYG{p}{,} \PYG{n}{QRELAX} \PYG{o}{=} \PYG{l+m+mf}{0.30}\PYG{p}{,} \PYG{n}{QAPHI} \PYG{o}{=} \PYG{l+m+mf}{0.50}\PYG{p}{,} \PYG{n}{EOSINT} \PYG{o}{=} \PYG{o}{.}\PYG{n}{FALSE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{K1} \PYG{o}{=} \PYG{l+m+mf}{110.0}\PYG{p}{,} \PYG{n}{GAMMA} \PYG{o}{=} \PYG{l+m+mf}{2.0}
\end{sphinxVerbatim}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{starplot_rho_b-6_unmag1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Section of the NS in the \(x-z\) plane along with the contours the density.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{starplot_chi_b-6_unmag1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Section of the NS in the \(x-z\) plane along with the contours the scalar field.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{rho_b-6_unmag1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the NS density at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{p_b-6_unmag1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the NS pressure at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{chi_b-6_unmag1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the scalar field at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{alpha_b-6_unmag1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the lapse function at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{psi_b-6_unmag1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the conformal factor at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\section{Non\sphinxhyphen{}rotating NS in STT with the POL2 EoS and a purely poloidal magnetic field}
\label{\detokenize{examples_stt:non-rotating-ns-in-stt-with-the-pol2-eos-and-a-purely-poloidal-magnetic-field}}
\sphinxAtStartPar
This is a model of an NS in STTs with \(\alpha _0 = -2.0\times 10^{-4}\) and \(\beta _0 = -6\) described by the analytic POL2 EoS, endowed with a purely poloidal field. It has a J\sphinxhyphen{}frame central density \(\rho _\mathrm{c}=8.30\times 10^{-4}\) in code units (corresponding to \(5.15\times 10^{14}\) gcm\(^{-3}\)) and a Komar mass in the E\sphinxhyphen{}frame of \(1.356\) M\( _\odot\). The circumferential radius in the J\sphinxhyphen{}frame is \(16.718\) km, and the E\sphinxhyphen{}frame scalar charge is \(0.564\) M\( _\odot\).

\sphinxAtStartPar
Here are the main parameters used to compute this model. The detailed log with all the parameters can be found in the corresponding LogFile.dat.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{NR} \PYG{o}{=} \PYG{l+m+mi}{900}\PYG{p}{,} \PYG{n}{NTH} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{NRREG} \PYG{o}{=} \PYG{l+m+mi}{600}\PYG{p}{,} \PYG{n}{MLS} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{NGQ} \PYG{o}{=} \PYG{l+m+mi}{50}\PYG{p}{,} \PYG{n}{RREG} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{RMAXSTR} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,}
\PYG{n}{RMAX} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{REQMAX} \PYG{o}{=} \PYG{l+m+mf}{25.0}\PYG{p}{,} \PYG{n}{RHOINI} \PYG{o}{=} \PYG{l+m+mf}{8.30E\PYGZhy{}4}\PYG{p}{,} \PYG{n}{ALPHA0} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.0E\PYGZhy{}4}\PYG{p}{,} \PYG{n}{BETA0} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{6}\PYG{p}{,} \PYG{n}{GR} \PYG{o}{=} \PYG{o}{.}\PYG{n}{FALSE}\PYG{o}{.}\PYG{p}{,}
\PYG{n}{STRETCH} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{ANALYTIC} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{CONVHELP} \PYG{o}{=} \PYG{o}{.}\PYG{n}{FALSE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{QFACTOR} \PYG{o}{=} \PYG{l+m+mf}{0.85}\PYG{p}{,} \PYG{n}{QFACTORCHI} \PYG{o}{=} \PYG{l+m+mf}{0.45}\PYG{p}{,}
\PYG{n}{QFACTORMETRIC} \PYG{o}{=} \PYG{l+m+mf}{0.35}\PYG{p}{,} \PYG{n}{QRELAX} \PYG{o}{=} \PYG{l+m+mf}{0.30}\PYG{p}{,} \PYG{n}{QAPHI} \PYG{o}{=} \PYG{l+m+mf}{0.50}\PYG{p}{,} \PYG{n}{EOSINT} \PYG{o}{=} \PYG{o}{.}\PYG{n}{FALSE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{K1} \PYG{o}{=} \PYG{l+m+mf}{110.0}\PYG{p}{,} \PYG{n}{GAMMA} \PYG{o}{=} \PYG{l+m+mf}{2.0}\PYG{p}{,}
\PYG{n}{IMAG} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{IPOL} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{KBPOL} \PYG{o}{=} \PYG{l+m+mf}{0.44}\PYG{p}{,} \PYG{n}{NPOL} \PYG{o}{=} \PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{n}{CSI} \PYG{o}{=} \PYG{l+m+mf}{0.0}
\end{sphinxVerbatim}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{starplot_rho_b-6_polo1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Section of the NS in the \(x-z\) plane along with the contours the density.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{starplot_chi_b-6_polo1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Section of the NS in the \(x-z\) plane along with the contours the scalar field.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{starplot_b_b-6_polo1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Section of the NS in the \(x-z\) plane along with the contours the poloidal magnetic field strength and its field lines.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{rho_b-6_polo1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the NS density at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{p_b-6_polo1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the NS pressure at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{chi_b-6_polo1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the scalar field at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{alpha_b-6_polo1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the lapse function at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{psi_b-6_polo1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the conformal factor at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{bpol_b-6_polo1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the poloidal magnetic field strength at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\section{Non\sphinxhyphen{}rotating NS in STT with the POL2 EoS and a purely toroidal magnetic field}
\label{\detokenize{examples_stt:non-rotating-ns-in-stt-with-the-pol2-eos-and-a-purely-toroidal-magnetic-field}}
\sphinxAtStartPar
This is a model of an NS in STTs with \(\alpha _0 = -2.0\times 10^{-4}\) and \(\beta _0 = -6\) described by the analytic POL2 EoS, endowed with a purely toroidal field. It has a J\sphinxhyphen{}frame central density \(\rho _\mathrm{c}=1.36\times 10^{-3}\) in code units (corresponding to \(8.44\times 10^{14}\) gcm\(^{-3}\)) and a Komar mass in the E\sphinxhyphen{}frame of \(1.467\) M\( _\odot\). The circumferential radius in the J\sphinxhyphen{}frame is \(20.916\) km, and the E\sphinxhyphen{}frame scalar charge is \(0.473\) M\( _\odot\).

\sphinxAtStartPar
Here are the main parameters used to compute this model. The detailed log with all the parameters can be found in the corresponding LogFile.dat.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{NR} \PYG{o}{=} \PYG{l+m+mi}{900}\PYG{p}{,} \PYG{n}{NTH} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{NRREG} \PYG{o}{=} \PYG{l+m+mi}{600}\PYG{p}{,} \PYG{n}{MLS} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{NGQ} \PYG{o}{=} \PYG{l+m+mi}{50}\PYG{p}{,} \PYG{n}{RREG} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{RMAXSTR} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,}
\PYG{n}{RMAX} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{REQMAX} \PYG{o}{=} \PYG{l+m+mf}{25.0}\PYG{p}{,} \PYG{n}{RHOINI} \PYG{o}{=} \PYG{l+m+mf}{1.36E\PYGZhy{}3}\PYG{p}{,} \PYG{n}{ALPHA0} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.0E\PYGZhy{}4}\PYG{p}{,} \PYG{n}{BETA0} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{6}\PYG{p}{,} \PYG{n}{GR} \PYG{o}{=} \PYG{o}{.}\PYG{n}{FALSE}\PYG{o}{.}\PYG{p}{,}
\PYG{n}{STRETCH} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{ANALYTIC} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{CONVHELP} \PYG{o}{=} \PYG{o}{.}\PYG{n}{FALSE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{QFACTOR} \PYG{o}{=} \PYG{l+m+mf}{0.85}\PYG{p}{,} \PYG{n}{QFACTORCHI} \PYG{o}{=} \PYG{l+m+mf}{0.45}\PYG{p}{,}
\PYG{n}{QFACTORMETRIC} \PYG{o}{=} \PYG{l+m+mf}{0.35}\PYG{p}{,} \PYG{n}{QRELAX} \PYG{o}{=} \PYG{l+m+mf}{0.30}\PYG{p}{,} \PYG{n}{QAPHI} \PYG{o}{=} \PYG{l+m+mf}{0.50}\PYG{p}{,} \PYG{n}{EOSINT} \PYG{o}{=} \PYG{o}{.}\PYG{n}{FALSE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{K1} \PYG{o}{=} \PYG{l+m+mf}{110.0}\PYG{p}{,} \PYG{n}{GAMMA} \PYG{o}{=} \PYG{l+m+mf}{2.0}\PYG{p}{,}
\PYG{n}{IMAG} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{ITOR} \PYG{o}{=} \PYG{o}{.}\PYG{n}{TRUE}\PYG{o}{.}\PYG{p}{,} \PYG{n}{BCOEF} \PYG{o}{=} \PYG{l+m+mf}{4.0}\PYG{p}{,} \PYG{n}{NPOL} \PYG{o}{=} \PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{n}{CSI} \PYG{o}{=} \PYG{l+m+mf}{0.0}
\end{sphinxVerbatim}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{starplot_rho_b-6_toro1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Section of the NS in the \(x-z\) plane along with the contours the density.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{starplot_chi_b-6_toro1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Section of the NS in the \(x-z\) plane along with the contours the scalar field.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{starplot_b_b-6_toro1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Section of the NS in the \(x-z\) plane along with the contours the toroidal magnetic field strength.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{rho_b-6_toro1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the NS density at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{p_b-6_toro1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the NS pressure at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{chi_b-6_toro1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the scalar field at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{alpha_b-6_toro1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the lapse function at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{psi_b-6_toro1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the conformal factor at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxincludegraphics{{btor_b-6_toro1}.png}
\\
\hline
\sphinxAtStartPar
\sphinxstyleemphasis{Radial profile of the toroidal magnetic field strength at the pole and at the equator.}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\sphinxAtStartPar
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\sphinxAtStartPar
\DUrole{xref,std,std-ref}{search}

\end{itemize}



\renewcommand{\indexname}{Index}
\printindex
\end{document}